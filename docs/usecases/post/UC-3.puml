@startuml
title UC-03 게시글 검색 (제목/전문/태그/카테고리)

actor 사용자 as User
participant "웹/앱 클라이언트" as Client
participant "BoardCraft API" as API
participant "SearchService" as Service
database "DB(Posts/Tags/Categories)" as DB

User -> Client : 검색어 입력 + 필터 선택
Client -> API : GET /api/v1/search\n?query&qf=title,body&tag&category\n&sort=relevance,published_at&page&size

API -> Service : searchPosts(params, user)

Service -> Service : 파라미터 정규화/검증(trim, 길이제한, 금칙어)
Service -> Service : 가시성 규칙 구성(is_published=1 or owner=user)

alt 유효한 query 존재
  Service -> DB : -- 제목/본문 Full-Text + 태그/카테고리 필터
  DB --> Service : posts[]
  Service --> API : SearchResultDTO(posts[], meta)
  API --> Client : 200 OK + JSON
  Client --> User : 검색 결과 리스트 렌더링(페이지네이션)
else query 비어있음/짧음
  Service --> API : BadRequest("query too short")
  API --> Client : 400 Bad Request
  Client --> User : 안내 표시(최소 n자 이상)
end
@enduml
